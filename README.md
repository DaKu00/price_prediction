# 물가지수, 날씨로 농산물 가격 예측
##### 팀명 : 용주시간이엄서영
##### 기간 : 2023. 07. 24 ~ 2023. 08. 17
##### 팀장 : 이용주
##### 팀원 : 공수찬, 김기주, 김형진, 엄서영

## 아이디어 배경
 - 장마, 폭우, 폭염 등 이상 기후 이후 농산물 가격의 폭등
 - 물가지수에 따라서도 농산물 가격이 많이 변동하는 것으로 보임
 - 그래서 물가지수, 날씨에 따라 미래의 농산물 가격을 예측

## 구현 내용
 - 연, 월, 일의 날짜 값을 입력해주면 해당 날짜의 특정 농산물의 가격을 예측

## 데이터 수집
 - 날씨 데이터, 물가지수 데이터를 각각 기상청과 공공 데이터 포털에서 수집
 - 특정 농산물의 가격은 웹 크롤링을 통해 수집
 - 각 데이터는 기간은 10년 일일 기준 데이터로 수집

## 데이터 전처리
 - x, y 값을 MinMaxScaler를 통해 정규화를 진행
   - y 값을 정규화 하지 않을 경우 0부터 1로 정규화된 x 값과 차이가 너무 많이 나서 로스의 수치가 크게 나옴
   - 로스 그래프 자체는 잘 수렴하는 것 같아 보이지만 MSE를 통해 봤을 때 로스 값이 만단위가 나와 너무 컸음
   - 그래서 y 값 또한 정규화를 진행해주는 것으로 0에 잘 수렴하게 됨
 - 예측하는 당일의 날씨는 가격에 영향을 미치지 않을 것으로 판단되고, 당월의 물가지수는 미리 나오지 않는 다는 것을 바탕으로
	 - 전월 물가지수와 가격을 예측하고 싶은 날짜의 30일 이전 기후를 새로운 피쳐로서 생성(파생변수 생성)
	 - 이전 기후의 평균 기온, 특정 강수량 이상의 강수횟수, 폭염 횟수를 새로운 피쳐로 생성
![image](https://github.com/DaKu00/price_prediction/assets/87750521/ec6e139d-a5ac-4e08-be60-f1a5ac47983a)
 - 날씨 데이터에는 비슷한 의미를 갖는 데이터가 많았음(1일 강수, 시간강수, 연속강수 등)
 - 피쳐 삭제, 다중공선성과 상관계수 분석을 바탕으로
   - 다중공선성 분석으로 비슷한 의미를 갖는 피쳐 삭제
	 - 상관계수 분석으로 학습에 불필요한 피쳐 삭제
	 - 두가지 분석으로 삭제한 후 score와 로스를 하나하나 비교, 단순 계수를 바탕으로 삭제한 것이 아님
	 - 삭제해야 좋다 나오는 계수여도 학습에서는 다르게 활용될 수 있음
  
![image](https://github.com/DaKu00/price_prediction/assets/87750521/0c36c343-c003-450d-af11-248e5daa2184)

  
## 모델 학습
 - 전처리된 데이터를 바탕으로 학습 진행
 - 기본 리니어모델, 라소, 릿지, 디시젼트리, 랜덤포레스트로 학습 테스트 진행
 - 릿지가 기본적인 성능이 가장 좋음
	 - 릿지를 그리드 서치를 통해 최적의 파라미터값 조정
 - 하나의 선형적 그래프로 예측 성능에 제약이 크다는 것으로 판단
	 - 폴리노미얼(다항회귀)이라는 방법을 적용
	 - 폴리노미얼을 적용하고 그리드서치까지 마치니 r2score 0.9를 넘김
 
![image](https://github.com/DaKu00/price_prediction/assets/87750521/e49a8185-2baf-4ac7-ac31-a10aa08b97d2)

## 결과
![image](https://github.com/DaKu00/price_prediction/assets/87750521/6dfa0e28-5a51-4bfb-bfe2-6dd061daa9c8)
 - 실제 값에 근사하게 예측 값이 출력되는 것을 확인

## 특이점
 - r2score는 잘 나오지만 로스가 너무 큰 현상이 있었음, 로스 그래프는 제대로 수렴하는 형상을 띔
 - 원인은 y값이 정규화가 이루어지지 않아서 로스가 수렴은 하지만 너무 큰 값을 갖는 현상
	 - 처음 x값만 민맥스스케일러로 정규화를진행하여 0에서 1 사이의 값이지만 y값은 가격으로 2000, 10000등 차이가 커서 생긴 것으로 판단
	 - y값 또한 민맥스 스케일러로 정규화 진행 후 0에 잘 수렴하는 형상을 보여주며 로스값 또한 잡을 수 있었음
 - 학습시에 y값을 정규화 진행하고 학습이 완료된 이후에 사용시에는 x값을 입력해주면 스케일 적용된 y값 도출
	 - 도출된 y값을 역변환 해주면 예측된 가격의 값을 볼 수 있음
